#!/bin/bash

# Check if the script is run with root privileges
if [ "$EUID" -ne 0 ]; then
  echo "Please run as root (use sudo)."
  exit 1
fi

# -------------------------------------------------------------------------
# Define different simulations by executing the create_containers.sh script
# -------------------------------------------------------------------------

# -------------------
# Showcase simulation
# -------------------
./create_containers.sh ubuntu 19 3 19 3 eedg noco nose 60 \
"M(1,1:00,3:00,5:00,7:00,9:00,11:00,13:00,15:00,17:00,19:00,21:00,23:00)\
-T(0,1:00,11:00)-W(1,3:00,11:00,14:00,18:00,23:00)\
-R(0,2:00,11:00,14:00,18:00,23:00)\
-F(1,2:00,11:00,14:00,18:00,22:00)\
-S(0,2:00,10:00)\
-U(0,2:00,10:00,13:00,17:00,21:00)"
./create_containers.sh ubuntu 19 11 19 11 eedg noco nose 60 \
"M(0,1:00,3:00,5:00,7:00,9:00,11:00,13:00,15:00,17:00,19:00,21:00,23:00)\
-T(1,3:00,11:00)\
-W(0,4:00,12:00,14:00,18:00,23:00)\
-R(1,2:00,11:00)\
-F(0,1:00,11:00,14:00,18:00,22:00)\
-S(1,2:00,11:00,14:00,18:00,22:00)\
-U(0,1:00,12:00,13:00,17:00,22:00)"
./create_containers.sh ubuntu 20 2 20 2 eedg noco nose 60 \
"M(1,1:00,3:00,5:00,7:00,9:00,11:00,13:00,15:00,17:00,19:00,21:00,23:00)\
-T(1,2:00,12:00)\
-W(1,3:00,12:00,22:00)\
-R(1,2:00,9:00)\
-F(0,3:00,10:00,15:00,20:00,23:00)\
-S(0,3:00,11:00,14:00,18:00,22:00,23:00)\
-U(0,2:00,12:00,13:00,17:00,22:00)"
./create_containers.sh ubuntu 20 11 20 11 eedg noco nose 60 \
"M(0,1:00,3:00,5:00,7:00,9:00,11:00,13:00,15:00,17:00,19:00,21:00,23:00)\
-T(1,2:00,12:00)\
-W(1,3:00,12:00,22:00)\
-R(1,2:00,9:00)\
-F(0,3:00,10:00,15:00,20:00,23:00)\
-S(0,3:00,11:00,14:00,18:00,22:00,23:00)\
-U(0,2:00,12:00,13:00,17:00,22:00)"
./create_containers.sh ubuntu 21 5 21 5 eedg noco nose 60 \
"M(1,1:00,3:00,5:00,7:00,9:00,11:00,13:00,15:00,17:00,19:00,21:00,23:00)\
-T(1,2:00,12:00)\
-W(1,3:00,12:00,14:00,18:00,22:00)\
-R(1,2:00,9:00)\
-F(0,3:00,10:00,15:00,20:00,23:00)\
-S(1,3:00,11:00,14:00,18:00,22:00,23:00)\
-U(0,5:00,12:00,13:00,18:00)"
./create_containers.sh ubuntu 21 9 21 9 eedg noco nose 60 \
"M(0,1:00,3:00,5:00,7:00,9:00,11:00,13:00,15:00,17:00,19:00,21:00,23:00)\
-T(1,2:00,12:00)\
-W(1,3:00,12:00,22:00)\
-R(1,2:00,9:00)\
-F(0,3:00,10:00,15:00,20:00,23:00)\
-S(0,3:00,11:00,14:00,18:00,22:00,23:00)\
-U(0,2:00,12:00,13:00,17:00,22:00)"
./create_containers.sh ubuntu 21 11 21 11 eedg noco nose 60 \
"M(1,1:00,3:00,5:00,7:00,9:00,11:00,13:00,15:00,17:00,19:00,21:00,23:00)\
-T(1,2:00,12:00)\
-W(1,3:00,12:00,14:00,18:00,22:00)\
-R(1,4:00,15:00,21:00)\
-F(0,3:00,10:00,15:00,20:00,23:00)\
-S(1,3:00,11:00,14:00,18:00,22:00,23:00)\
-U(0,2:00,12:00,13:00,17:00,22:00)"
./create_containers.sh ubuntu 21 15 21 15 eedg noco nose 60 \
"M(0,1:00,3:00,5:00,7:00,9:00,11:00,13:00,15:00,17:00,19:00,21:00,23:00)\
-T(9:00,11:00,17:00,22:00)\
-W(1,3:00,12:00,14:00,18:00,22:00)\
-R(1,2:00,9:00)\
-F(0,3:00,10:00,15:00,20:00,23:00)\
-S(1,4:00,15:00,21:00)\
-U(0,2:00,12:00,13:00,17:00,22:00)"
./create_containers.sh ubuntu 21 17 21 17 eedg noco nose 60 \
"M(1,1:00,3:00,5:00,7:00,9:00,11:00,13:00,15:00,17:00,19:00,21:00,23:00)\
-T(1,2:00,12:00)\
-W(1,3:00,12:00,14:00,18:00,22:00)\
-R(9:00,11:00,17:00,22:00)\
-F(0,3:00,10:00,15:00,20:00,23:00)\
-S(1,3:00,11:00,14:00,18:00,22:00,23:00)\
-U(0,5:00,12:00,13:00,18:00)"
./create_containers.sh ubuntu 22 7 22 7 eedg noco nose 60 \
"M(0,1:00,3:00,5:00,7:00,9:00,11:00,13:00,15:00,17:00,19:00,21:00,23:00)\
-T(1,2:00,12:00)\
-W(1,3:00,12:00,14:00,18:00,22:00)\
-R(1,2:00,9:00)\
-F(0,3:00,10:00,15:00,20:00,23:00)\
-S(1,3:00,11:00,14:00,18:00,22:00,23:00)\
-U(0,5:00,12:00,13:00,18:00)"
./create_containers.sh ubuntu 22 12 22 12 eedg noco nose 60 \
"M(1,1:00,3:00,5:00,7:00,9:00,11:00,13:00,15:00,17:00,19:00,21:00,23:00)\
-T(1,2:00,11:00,16:00,22:00)\
-W(1,3:00,12:00,14:00,18:00,22:00)\
-R(2:00,12:00,13:00,17:00,22:00)\
-F(0,3:00,10:00,15:00,20:00,23:00)\
-S(1,2:00,7:00,15:00,20:00)\
-U(0,2:00,12:00,13:00,17:00,22:00)"
./create_containers.sh ubuntu 22 15 22 15 eedg noco nose 60 \
"M(1,1:00,3:00,5:00,7:00,9:00,11:00,13:00,15:00,17:00,19:00,21:00,23:00)\
-T(1,2:00,12:00)\
-W(1,3:00,12:00,14:00,18:00,22:00)\
-R(1,2:00,9:00)\
-F(0,3:00,10:00,15:00,20:00,23:00)\
-S(1,3:00,11:00,14:00,18:00,22:00,23:00)\
-U(0,2:00,12:00,13:00,17:00,22:00)"
./create_containers.sh ubuntu 23 9 23 9 core purp nose
./create_containers.sh ubuntu 23 10 23 10 core purp nose
./create_containers.sh ubuntu 24 8 24 8 edge purp nose
./create_containers.sh ubuntu 24 9 24 9 core purp nose
./create_containers.sh ubuntu 24 10 24 10 core purp nose
./create_containers.sh ubuntu 25 3 25 3 eedg noco nose 60 \
"M(0,1:00,3:00,5:00,7:00,9:00,11:00,13:00,15:00,17:00,19:00,21:00,23:00)\
-T(0,2:00,12:00)\
-W(0,2:00,12:00,14:00,18:00,22:00)\
-R(1,2:00,9:00,11:00,14:00,18:00)\
-F(1,3:00,10:00,15:00,20:00,23:00)\
-S(1,3:00,11:00,14:00,18:00,22:00,23:00)\
-U(0,2:00,12:00,13:00,17:00,22:00)"
./create_containers.sh ubuntu 25 8 25 8 edge purp nose
./create_containers.sh ubuntu 25 9 25 9 edge purp nose
./create_containers.sh ubuntu 26 8 26 8 edge purp nose
./create_containers.sh ubuntu 26 9 26 9 edge purp nose
./create_containers.sh ubuntu 26 10 26 10 edge purp nose
# -------------------

lxc list --fast

# Create temporal_files directory if it does not exist
mkdir -p temporal_files

# Dump containers info into a file
echo "Waiting for 3 seconds for all the container IPs to be available..."
sleep 3
lxc list > "temporal_files/containers_list.tmp"
# Dump containers names into a file
lxc list -c n --format csv > "temporal_files/container_names_list.tmp"

num_cntrs=$(lxc list --fast | grep -c ubuntu)
echo "Total number of containers: $num_cntrs"